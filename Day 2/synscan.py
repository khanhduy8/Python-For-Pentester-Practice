from scapy.all import *
import ipaddress

ports = [21, 22, 80, 443, 8080]
def synscan(host):
    ans, unans = sr(
        IP(dst=host)/TCP(sport=33334, dport=ports, flags="S"),
    timeout=2, verbose=0, iface=IFACES.dev_from_index(17))
    #IFACES id 17 is WIFI Interface
    for (s,r,) in ans:
        if s[TCP].dport == r[TCP].sport and r[TCP].flags=='SA':
            print(s[TCP].dport)

host = input("Nhap vao so IP: ")
try:
    ipaddress.ip_address(host)
except:
    print("Hay nhap vao so IP")
    exit(-1)

synscan(host)